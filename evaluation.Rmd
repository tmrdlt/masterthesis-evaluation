---
output:
  html_document: default
  pdf_document: default
---
```{r}
getwd()
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

nasa_tlx <- read_excel("data/nasa_tlx_data.xlsx")

data <- nasa_tlx %>%
  pivot_longer(cols = c(`Workload`, `Sense of control`, `Creativity Support Index`), names_to="variable", values_to="value") %>%
  group_by(variable) %>%
  summarize_at(vars(value), list(~mean(.), ~sd(.))) %>%
  arrange(factor(variable, levels = c("Workload", "Sense of control", "Creativity Support Index")))


plot <- data %>%
  ggplot( aes(x=factor(variable, level=variable), y=mean, fill=variable)) + 
  geom_bar(position="dodge", stat="identity", colour = "#000000") + 
  geom_errorbar(aes(x=variable, ymin=mean-sd, ymax=mean+sd), width=0.2) + 
  scale_y_continuous(breaks = c(0, 20, 40, 60, 80, 100), limits=c(0,100)) +
  xlab(" ") + ylab("Mean") +
  guides(fill="none") +
  theme_minimal() +
  scale_fill_brewer(palette = "Blues")

print(plot)

ggsave("plots/bar_nasa_tlx_plot.eps",
       plot = plot,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
```

```{r}
getwd()
library(readxl)
library(reshape2)
library(ggplot2)

diff_h <- read_excel("data/Diff.xlsx", sheet = "diff_h")
diff_due <- read_excel("data/Diff.xlsx", sheet = "diff_due")
diff_order <- read_excel("data/Diff.xlsx", sheet = "diff_order")

data_h <- melt(diff_h, id.vars=c("Participant ID", "Type"))
data_due <- melt(diff_due, id.vars=c("Participant ID", "Type"))
data_order <- melt(diff_order, id.vars=c("Participant ID"))

plot_h <- data_h %>%
  ggplot(aes(x=factor(Type, level=unique(Type)), y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  xlab("Error type") + ylab("Working hours") + 
  theme_minimal() + 
  theme(legend.title = element_blank()) +
  scale_fill_brewer(palette = "Blues")

plot_due <- data_due %>%
  ggplot(aes(x=factor(Type, level=unique(Type)), y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  xlab("Error type") + ylab("Missed due dates") +
  theme_minimal() + 
  theme(legend.title = element_blank()) +
  scale_fill_brewer(palette = "Blues")

plot_order <- data_order %>%
  ggplot(aes(x=variable, y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  scale_y_continuous(breaks = c(.2, .4, .6, .8, 1), limits=c(0,1)) +
  xlab(" ") + ylab("Similarity to proposed order") + 
  guides(fill="none") +
  theme_minimal() + 
  scale_fill_brewer(palette = "Blues")

plot_h
plot_due
plot_order

ggsave("plots/box_diff_h.eps",
       plot = plot_h,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
ggsave("plots/box_diff_due.eps",
       plot = plot_due,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
ggsave("plots/box_diff_order.eps",
       plot = plot_order,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
```

```{r}
getwd()
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

events <- read_excel("data/Task1.xlsx", sheet = "events")

data <- events %>%
  pivot_longer(cols=c(4:11), names_to="variable", values_to="value") %>%
  group_by(`Used before`, variable) %>%
  summarise_at(vars(value), list(~mean(.), ~sd(.)))

plot <- data %>%
  ggplot(aes(x=reorder(variable, -mean), y=mean, fill=factor(`Used before`))) + 
  geom_bar(stat="identity", position = "dodge") + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.2, position=position_dodge(.9)) + 
  xlab("Event type") + ylab("Events") +
  theme_minimal() +
  theme(legend.position="top") + 
  scale_fill_manual(values=c("#F87171", "#34D399"), 
                    name="Have you used board based tools before?",
                    labels=c("no (n=3)", "yes (n=10)"))
print(plot)

ggsave("plots/bar_events_by_exp.eps",
       plot = plot,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
```

```{r}
getwd()
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

nesting <- read_excel("data/Task1.xlsx", sheet = "nesting")

data <- nesting %>% pivot_longer(cols=-c(`Participant ID`), names_to="variable", values_to="value") %>% 
  group_by(variable) %>% 
  summarize_at(vars(value), list(~mean(.), ~sd(.))) %>%
  arrange(factor(variable, levels = c("Standard", "Personal", "Favourite of proposed", "Favourite overall")))

plot <- data %>%
  ggplot(aes(x=factor(variable, level=variable), y=mean, fill=variable)) + 
  geom_bar(stat="identity", position = "dodge", colour = "#000000") + 
  geom_errorbar(aes(x=variable, ymin=mean-sd, ymax=mean+sd), width=0.2) + 
  xlab("Arrangement") + ylab("Nesting level") +
  guides(fill="none") +
  theme_minimal() +
  scale_fill_brewer(palette = "Blues")

print(plot)

ggsave("plots/bar_preffered_nesting_level",
       plot = plot,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)

```




```{r}
getwd()
library(readxl)
events <- read_excel("data/Task1.xlsx", sheet = "events")
View(events)

c1 <- cor.test(events$`Used before`, events$`All events`)
c2 <-cor.test(events$`Used before`, events$move)
c3 <- cor.test(events$`Used before`, events$create)

c4 <- cor.test(events$`Prior experience`, events$`All events`)
c5 <- cor.test(events$`Prior experience`, events$move)
c6 <- cor.test(events$`Prior experience`, events$create)
```