---
output:
  html_document: default
  pdf_document: default
---
```{r}
getwd()
library(readxl)
nasa_tlx <- read_excel("data/nasa_tlx_data.xlsx")
# View(nasa_tlx)

library(ggsci)
library(ggthemes)
library(ggplot2)

workload <- nasa_tlx$Workload
control <- nasa_tlx$`Sense of control`
creativity <- nasa_tlx$`Creativity Support Index`
value <- c(mean(workload), mean(control), mean(creativity))
sd <- c(sd(workload), sd(control), sd(creativity))
name <- c("Workload", "Sense of control", "Creativity Support Index")

data <- data.frame(name, value, sd)
nasa_tlx_plot <- ggplot(data, aes(fill=name, x=factor(name, level=name), y=value)) + 
  geom_bar(position="dodge", stat="identity", colour = "#000000") + 
  geom_errorbar(aes(x=name, ymin=value-sd, ymax=value+sd), width=0.2) + 
  scale_y_continuous(breaks = c(0, 20, 40, 60, 80, 100), limits=c(0,100)) +
  xlab(" ") + ylab("Mean") +
  guides(fill="none") +
  theme_minimal() +
  scale_fill_brewer(palette = "Blues")+
  theme(legend.position="bottom")

print(nasa_tlx_plot)

ggsave("plots/nasa_tlx_plot.eps",
       plot = nasa_tlx_plot,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
```

```{r}
getwd()
library(readxl)

library(ggsci)
library(ggthemes)
library(ggplot2)
library(reshape2)
library(gridExtra)

diff_h <- read_excel("data/Diff.xlsx", sheet = "diff_h")
diff_due <- read_excel("data/Diff.xlsx", sheet = "diff_due")
diff_order <- read_excel("data/Diff.xlsx", sheet = "diff_order")

data_h <- melt(diff_h, id.vars=c("Participant ID", "Type"))
data_due <- melt(diff_due, id.vars=c("Participant ID", "Type"))
data_order <- melt(diff_order, id.vars=c("Participant ID"))

plot_h <- ggplot(data_h, aes(x=factor(Type, level=unique(Type)), y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  xlab("Error type") + ylab("Working hours") + 
  theme_minimal() + 
  theme(legend.title = element_blank()) +
  scale_fill_brewer(palette = "Blues")

plot_due <- ggplot(data_due, aes(x=factor(Type, level=unique(Type)), y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  xlab("Error type") + ylab("Missed due dates") +
  theme_minimal() + 
  theme(legend.title = element_blank()) +
  scale_fill_brewer(palette = "Blues")

plot_order <- ggplot(melt(diff_order, id.vars=c("Participant ID")), aes(x=variable, y=value, fill=variable)) + 
  geom_boxplot() + 
  # geom_jitter() +
  xlab(" ") + ylab("Similarity to proposed order") + 
  guides(fill="none") +
  theme_minimal() + 
  scale_fill_brewer(palette = "Blues")

plot_h
plot_due
plot_order

ggsave("plots/diff_h.eps",
       plot = plot_h,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
ggsave("plots/diff_due.eps",
       plot = plot_due,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
ggsave("plots/diff_order.eps",
       plot = plot_order,
       device = "eps",
       scale = 1, units = "cm",
       dpi = 300,
       limitsize = TRUE)
```

